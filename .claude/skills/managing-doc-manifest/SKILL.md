---
name: managing-doc-manifest
description: Creates and maintains .doc-manifest.yaml files tracking project documentation. Lists all docs, their types, last-updated timestamps, and code references. Activates when user asks to "create doc manifest", "update manifest", "doc inventory", "list docs", or mentions documentation tracking.
license: MIT
metadata:
  version: "1.0.0"
  author: gradigit
  tags:
    - documentation
    - manifest
    - tracking
  triggers:
    - "create doc manifest"
    - "update manifest"
    - "doc inventory"
    - "list docs"
---

# Managing Doc Manifest

Creates and maintains `.doc-manifest.yaml` — a registry of all documentation files in a project, what code they reference, and when they were last updated.

## Workflow

- [ ] 1. Check for existing `.doc-manifest.yaml`
- [ ] 2. Scan project for documentation files
- [ ] 3. Analyze each doc for code references
- [ ] 4. Write/update `.doc-manifest.yaml`
- [ ] 5. Show summary

## Step 1: Check Existing Manifest

Read `.doc-manifest.yaml` if it exists. Compare against current state.

## Step 2: Scan for Documentation

Auto-discover all documentation files:

```
# Standard locations
CLAUDE.md
README.md
ARCHITECTURE.md
CHECKLIST.md
CHANGELOG.md
CONTRIBUTING.md
docs/**/*.md
*.md (project root)
```

Exclude:
- `node_modules/**`
- `venv/**`, `.venv/**`
- `.git/**`
- `**/CHANGELOG.md` inside dependencies

## Step 3: Analyze Code References

For each doc file, extract referenced code files:

### Detection Methods

1. **Explicit paths**: `src/validators/comparator.py` mentioned in text
2. **Code blocks**: File paths in fenced code blocks (```bash, ```python)
3. **Table entries**: File paths in markdown tables
4. **Import references**: `from src.models import ...` patterns

### Reference Types

| Type | Example | Detection |
|------|---------|-----------|
| `file` | `src/main.py` | Path-like string that matches existing file |
| `directory` | `src/validators/` | Path ending with `/` |
| `glob` | `src/**/*.py` | Path with wildcards |
| `command` | `pytest tests/ -v` | Executable in code block |

## Step 4: Write Manifest

### Schema

```yaml
# .doc-manifest.yaml
# Auto-generated by managing-doc-manifest skill
# Manual edits are preserved on re-scan

version: "1.0"
last_synced: "{current ISO-8601 timestamp}"

files:
  - path: CLAUDE.md
    type: claude-instructions
    last_updated: "{file modification timestamp}"
    references:
      - src/validators/comparator.py
      - src/validators/preflight.py
      - config/settings.yaml
      - main.py

  - path: README.md
    type: readme
    last_updated: "{file modification timestamp}"
    references:
      - main.py
      - requirements.txt

  - path: docs/ARCHITECTURE.md
    type: architecture
    last_updated: "{file modification timestamp}"
    references:
      - src/**/*.py
      - config/*.yaml
```

### Document Types

| Type | Description |
|------|-------------|
| `claude-instructions` | CLAUDE.md files (project or directory-level) |
| `readme` | README.md |
| `architecture` | ARCHITECTURE.md or similar design docs |
| `checklist` | CHECKLIST.md, TODO.md, progress tracking |
| `changelog` | CHANGELOG.md |
| `guide` | User guides, tutorials, how-to docs |
| `api` | API documentation |
| `other` | Any other .md file |

### Update Rules

When updating an existing manifest:
- **Preserve manually added entries** (files not found by auto-scan)
- **Add newly discovered files**
- **Remove entries for deleted files** (mark with comment if unsure)
- **Update `last_updated`** timestamps from file system
- **Update `references`** by re-scanning doc content
- **Always update `last_synced`** to current time

## Step 5: Show Summary

```
=== Doc Manifest Summary ===

File: .doc-manifest.yaml

Tracked: 5 documentation files
  CLAUDE.md (claude-instructions) - refs: 4 code files
  README.md (readme) - refs: 2 code files
  docs/ARCHITECTURE.md (architecture) - refs: 2 glob patterns
  CHECKLIST.md (checklist) - refs: 0
  docs/guide.md (guide) - refs: 3 code files

New: 1 file added (docs/guide.md)
Removed: 0 files
Updated references: 2 files (CLAUDE.md, docs/ARCHITECTURE.md)
```

## Example

**Input:**
```
/doc-manifest
```

**Context:** Project at `/home/user/projects/my-app/` with CLAUDE.md, ARCHITECTURE.md, CHECKLIST.md.

**Output:**
```
=== Doc Manifest Summary ===

Created: .doc-manifest.yaml

Tracked: 4 documentation files
  CLAUDE.md (claude-instructions) - refs: 7 code files
  docs/ARCHITECTURE.md (architecture) - refs: 5 code files
  CHECKLIST.md (checklist) - refs: 0
  docs/API.md (api) - refs: 3 code files

Path: /home/user/projects/my-app/.doc-manifest.yaml
```

## Integration with syncing-docs

The syncing-docs skill uses this manifest to:
1. Know which docs to check for staleness
2. Know which code files each doc references (for targeted reads)
3. Update `last_synced` and `last_updated` after applying changes

## Self-Evolution

Update this skill when:
1. **On missed doc file**: Auto-discovery didn't find a doc → add pattern to Step 2
2. **On missed reference**: Code path in doc not detected → add detection method to Step 3
3. **On schema change**: New metadata needed → update schema in Step 4

**Applied Learnings:**
- v1.0.0: Initial version
